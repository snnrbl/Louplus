/********************************************************************************
 * Copyright (C) 2019 TypeFox and others.
 *
 * This program and the accompanying materials are made available under the
 * terms of the Eclipse Public License v. 2.0 which is available at
 * http://www.eclipse.org/legal/epl-2.0.
 *
 * This Source Code may also be made available under the following Secondary
 * Licenses when the conditions for such availability set forth in the Eclipse
 * Public License v. 2.0 are satisfied: GNU General Public License, version 2
 * with the GNU Classpath Exception which is available at
 * https://www.gnu.org/software/classpath/license.html.
 *
 * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0
 ********************************************************************************/
import { interfaces } from 'inversify';
import URI from '@theia/core/lib/common/uri';
import { Emitter } from '@theia/core/lib/common/event';
import { CancellationToken } from '@theia/core/lib/common/cancellation';
import { CommandService } from '@theia/core/lib/common/command';
import { LabelProvider } from '@theia/core/lib/browser/label-provider';
import { EditorOpenerOptions, EditorManager } from '@theia/editor/lib/browser/editor-manager';
import { FileSystem } from '@theia/filesystem/lib/common';
import { Repository, Git, GitFileChange, WorkingDirectoryStatus } from '../common';
import { GitErrorHandler } from './git-error-handler';
import { EditorWidget } from '@theia/editor/lib/browser';
import { ScmProvider, ScmCommand, ScmResourceGroup, ScmAmendSupport, ScmCommit } from '@theia/scm/lib/browser/scm-provider';
export declare class GitScmProviderOptions {
    repository: Repository;
}
export declare class GitScmProvider implements ScmProvider {
    protected readonly onDidChangeEmitter: Emitter<void>;
    readonly onDidChange: import("@theia/core/lib/common/event").Event<void>;
    protected fireDidChange(): void;
    private readonly onDidChangeStatusBarCommandsEmitter;
    readonly onDidChangeStatusBarCommands: import("@theia/core/lib/common/event").Event<ScmCommand[] | undefined>;
    private readonly toDispose;
    protected readonly editorManager: EditorManager;
    protected readonly gitErrorHandler: GitErrorHandler;
    protected readonly fileSystem: FileSystem;
    protected readonly git: Git;
    protected readonly commands: CommandService;
    protected readonly labelProvider: LabelProvider;
    protected readonly options: GitScmProviderOptions;
    readonly id = "git";
    readonly label = "Git";
    dispose(): void;
    protected init(): void;
    readonly repository: Repository;
    readonly rootUri: string;
    protected _amendSupport: GitAmendSupport;
    readonly amendSupport: GitAmendSupport;
    readonly acceptInputCommand: ScmCommand | undefined;
    protected _statusBarCommands: ScmCommand[] | undefined;
    statusBarCommands: ScmCommand[] | undefined;
    protected state: GitScmProvider.State;
    readonly groups: ScmResourceGroup[];
    readonly stagedChanges: GitFileChange[];
    readonly unstagedChanges: GitFileChange[];
    readonly mergeChanges: GitFileChange[];
    getStatus(): WorkingDirectoryStatus | undefined;
    setStatus(status: WorkingDirectoryStatus | undefined, token: CancellationToken): Promise<void>;
    protected createGroup(id: string, label: string, changes: GitFileChange[], hideWhenEmpty?: boolean): Promise<ScmResourceGroup>;
    protected addScmResource(group: ScmResourceGroup, change: GitFileChange): Promise<void>;
    open(change: GitFileChange, options?: EditorOpenerOptions): Promise<void>;
    getUriToOpen(change: GitFileChange): URI;
    openChange(change: GitFileChange, options?: EditorOpenerOptions): Promise<EditorWidget>;
    findChange(uri: URI): GitFileChange | undefined;
    stageAll(): Promise<void>;
    stage(uri: string): Promise<void>;
    unstageAll(): Promise<void>;
    unstage(uri: string): Promise<void>;
    discardAll(): Promise<void>;
    discard(uri: string): Promise<void>;
    protected confirm(path: string): Promise<boolean | undefined>;
    protected confirmAll(): Promise<boolean | undefined>;
    protected delete(uri: URI): Promise<void>;
    protected deleteAll(uris: string[]): Promise<void>;
}
export declare namespace GitScmProvider {
    interface State {
        status?: WorkingDirectoryStatus;
        stagedChanges: GitFileChange[];
        unstagedChanges: GitFileChange[];
        mergeChanges: GitFileChange[];
        groups: ScmResourceGroup[];
    }
    function initState(status?: WorkingDirectoryStatus): GitScmProvider.State;
    const Factory: unique symbol;
    type Factory = (options: GitScmProviderOptions) => GitScmProvider;
    function createFactory(ctx: interfaces.Context): Factory;
}
export declare class GitAmendSupport implements ScmAmendSupport {
    protected readonly repository: Repository;
    protected readonly git: Git;
    constructor(repository: Repository, git: Git);
    getInitialAmendingCommits(amendingHeadCommitSha: string, latestCommitSha: string): Promise<ScmCommit[]>;
    getMessage(commit: string): Promise<string>;
    reset(commit: string): Promise<void>;
    getLastCommit(): Promise<ScmCommit | undefined>;
    private createScmCommit;
}
//# sourceMappingURL=git-scm-provider.d.ts.map